# Use an official Python runtime as a parent image
FROM python:3.9

WORKDIR /api

# Copy only the requirements file first to leverage Docker cache
COPY ./api/requirements.txt /api/requirements.txt

# Install application dependencies
RUN pip install --trusted-host pypi.python.org -r requirements.txt

# Install fixed dependencies
RUN pip install pytest httpx pytest-asyncio

# pytest and hide all warnings
CMD ["pytest", "-p", "no:warnings"]